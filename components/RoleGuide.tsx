import React, { useState } from 'react';
import { ROLE_CONFIGURATIONS } from '../constants';
import { Role } from '../types';

interface RoleGuideProps {
  onClose: () => void;
}

const ROLE_GUIDE_CONTENT = {
    [Role.Merlin]: {
        name: "ูุฑูู ๐งโโ๏ธ",
        ability: "ุชูุงู ุงูุฑุงุฏ ุชู ุดุฑ ุฑุง ูโุดูุงุณุฏ (ุจู ุฌุฒ ููุฑุฏุฑุฏ).",
        strategy: "ูุธูู ุดูุง ูุฏุงุช ุชู ูฺฉ ุจู ุณูุช ูพุฑูุฒ ุงุณุชุ ุงูุง ุจุฏูู ุงูฺฉู ููุชโุชุงู ูุงุด ุดูุฏ. ุจุง ุฑุฃโูุง ุฎูุฏ ุจู ุชูโูุง ุฎูุจ ู ุจุฏุ ุจู ุงุฑุงูโุชุงู ุณุฑูุฎ ุจุฏูุฏ. ุงุฒ ุญุฑู ุฒุฏู ูุณุชูู ุฎูุฏุฏุงุฑ ฺฉูุฏ. ุจู ุงุฏ ุฏุงุดุชู ุจุงุดุฏุ ุงฺฏุฑ ุขุฏูฺฉุด ุดูุง ุฑุง ูพุฏุง ฺฉูุฏุ ุจุงุฒูุฏู ูโุดูุฏ.",
        question: "ฺฺฏููู ุจุฏูู ุญุฑู ุฒุฏู ุจู ุงุฑุงูู ฺฉูฺฉ ฺฉููุ ุจุง ุฑุฃ ุฏุงุฏู ุจู ุชูโูุง ฺฉู ููุท ุงูุฑุงุฏ ุฎูุจ ุฏุฑ ุขู ูุณุชูุฏ ู ุฑุฃ ูุฎุงูู ุฏุงุฏู ุจู ุชูโูุง ฺฉู ุดุฑูุฑ ุฏุงุฑูุฏุ ูโุชูุงูุฏ ูพุงู ุฎูุฏ ุฑุง ุจุฑุณุงูุฏ."
    },
    [Role.Percival]: {
        name: "ูพุฑุณูุงู ๐ก๏ธ",
        ability: "ูุฑูู ู ููุฑฺฏุงูุง ุฑุง ูโุจูุฏ ูู ููโุฏุงูุฏ ฺฉุฏุงู ฺฉ ฺฉุณุช.",
        strategy: "ุดูุง ูุญุงูุธ ูุฑูู ูุณุชุฏ. ุฏุฑ ุงุจุชุฏุง ุจุงุฒ ุฏู ููุฑ ุจู ุดูุง ูุดุงู ุฏุงุฏู ูโุดููุฏ. ฺฉ ูุฑูู ู ุฏฺฏุฑ ููุฑฺฏุงูุง ุงุณุช. ุจู ุฑูุชุงุฑ ุงู ุฏู ููุฑ ุฏุฑ ุทูู ุจุงุฒ ุฏูุช ฺฉูุฏ. ูุฑูู ุณุน ูโฺฉูุฏ ูุญุชุงุทุงูู ุชู ุฑุง ุฑุงูููุง ฺฉูุฏุ ุฏุฑ ุญุงู ฺฉู ููุฑฺฏุงูุง ุชูุงุด ูโฺฉูุฏ ูพุฑุณูุงู ุฑุง ฺฏูุฑุงู ฺฉูุฏ.",
        question: "ุงฺฏุฑ ูุฑ ุฏู ููุฑ ฺฉู ูโุจูู ุงุฏุนุง ูุฑูู ุจูุฏู ฺฉุฑุฏูุฏ ฺู ฺฉููุ ุจู ุฑุฃโูุง ู ุตุญุจุชโูุงุดุงู ุฏูุช ฺฉูุฏ. ูุนูููุงู ูุฑูู ูุงูุน ููุทูโุชุฑ ุนูู ูโฺฉูุฏ."
    },
    [Role.Tristan]: {
        name: "ุชุฑุณุชุงู ๐",
        ability: "ุงุฒููุช ุฑุง ุฏุฑ ุงุจุชุฏุง ุจุงุฒ ูโุดูุงุณุฏ.",
        strategy: "ุดูุง ุจุงุฒ ุฑุง ุจุง ฺฉ ุงุฑ ฺฉุงููุงู ูุงุจู ุงุนุชูุงุฏ ุดุฑูุน ูโฺฉูุฏ. ุงู ฺฉ ูุฒุช ุจุฒุฑฺฏ ุงุณุช. ุจุง ููุงููฺฏ ฺฉุงูู ุจุง ุงุฒููุชุ ูโุชูุงูุฏ ุจู ุดูุงุณุง ุงูุฑุงุฏ ุดุฑูุฑ ู ุญูุงุช ุงุฒ ูุฑูู ฺฉูฺฉ ฺฉูุฏ. ูโุชูุงูุฏ ุชุตูู ุจฺฏุฑุฏ ฺฉู ุฑุงุจุทูโุชุงู ุฑุง ูุงุด ฺฉูุฏ ุง ูุฎู ูฺฏู ุฏุงุฑุฏ ุชุง ุฏุฑ ูุญุธู ููุงุณุจ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ.",
        question: "ุขุง ุจุงุฏ ุจู ููู ุจฺฏูู ฺฉู ุชุฑุณุชุงู ูุณุชูุ ุงู ฺฉ ุชุตูู ุงุณุชุฑุงุชฺฺฉ ุงุณุช. ูุงุด ฺฉุฑุฏู ููุชโุชุงู ูโุชูุงูุฏ ุจู ุชู ูฺฉ ฺฉูฺฉ ฺฉูุฏ ุงูุง ุดูุง ุฑุง ุจู ูุฏูโูุง ุงุญุชูุงู ุจุฑุง ุชู ุดุฑ ุชุจุฏู ูโฺฉูุฏ."
    },
    [Role.Isolde]: {
        name: "ุงุฒููุช ๐",
        ability: "ุชุฑุณุชุงู ุฑุง ุฏุฑ ุงุจุชุฏุง ุจุงุฒ ูโุดูุงุณุฏ.",
        strategy: "ุดูุง ุจุงุฒ ุฑุง ุจุง ฺฉ ุงุฑ ฺฉุงููุงู ูุงุจู ุงุนุชูุงุฏ ุดุฑูุน ูโฺฉูุฏ. ุงู ฺฉ ูุฒุช ุจุฒุฑฺฏ ุงุณุช. ุจุง ููุงููฺฏ ฺฉุงูู ุจุง ุชุฑุณุชุงูุ ูโุชูุงูุฏ ุจู ุดูุงุณุง ุงูุฑุงุฏ ุดุฑูุฑ ู ุญูุงุช ุงุฒ ูุฑูู ฺฉูฺฉ ฺฉูุฏ. ูโุชูุงูุฏ ุชุตูู ุจฺฏุฑุฏ ฺฉู ุฑุงุจุทูโุชุงู ุฑุง ูุงุด ฺฉูุฏ ุง ูุฎู ูฺฏู ุฏุงุฑุฏ ุชุง ุฏุฑ ูุญุธู ููุงุณุจ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ.",
        question: "ุขุง ุจุงุฏ ุจู ููู ุจฺฏูู ฺฉู ุงุฒููุช ูุณุชูุ ุงู ฺฉ ุชุตูู ุงุณุชุฑุงุชฺฺฉ ุงุณุช. ูุงุด ฺฉุฑุฏู ููุชโุชุงู ูโุชูุงูุฏ ุจู ุชู ูฺฉ ฺฉูฺฉ ฺฉูุฏ ุงูุง ุดูุง ุฑุง ุจู ูุฏูโูุง ุงุญุชูุงู ุจุฑุง ุชู ุดุฑ ุชุจุฏู ูโฺฉูุฏ."
    },
    [Role.LoyalServant]: {
        name: "ุฎุฏูุชฺฏุฒุงุฑ ููุงุฏุงุฑ ุขุฑุชูุฑ ๐",
        ability: "ูฺ ูุงุจูุช ูฺูโุง ูุฏุงุฑุฏ.",
        strategy: "ุดูุง ฺุดู ู ฺฏูุด ุชู ูฺฉ ูุณุชุฏ. ฺูู ุงุทูุงุนุงุช ูุฏุงุฑุฏุ ุจุงุฏ ุจุง ุฏูุช ุจู ุฑุฃโฺฏุฑโูุงุ ุชุฑฺฉุจ ุชูโูุง ู ูุชุงุฌ ูุงููุฑุชโูุง ูฺฏุงู ฺฉูุฏ. ูุฏุฑุช ุดูุง ุฏุฑ ุฑุฃโุชุงู ู ุชุดุฎุต ุชูุงูุถ ุฏุฑ ุฑูุชุงุฑ ุฏฺฏุฑุงู ุงุณุช. ุจู ุญุณ ุฎูุฏ ุงุนุชูุงุฏ ฺฉูุฏ.",
        question: "ูู ฺฉู ุงุทูุงุนุงุช ูุฏุงุฑูุ ฺฺฏููู ููุฏ ุจุงุดูุ ุชุญูู ุฑูุชุงุฑ ุจุงุฒฺฉูุงู ฺฉูุฏ ููููุช ุดูุงุณุช. ุจุจูุฏ ฺู ฺฉุณ ุจู ุชูโูุง ูุดฺฉูฺฉ ุฑุฃ ูุซุจุช ูโุฏูุฏ ุง ฺู ฺฉุณ ุฏุฑ ูุงููุฑุชโูุง ุดฺฉุณุชโุฎูุฑุฏู ุญุถูุฑ ุฏุงุดุชู."
    },
    [Role.Morgana]: {
        name: "ููุฑฺฏุงูุง ๐ฎ",
        ability: "ุจุฑุง ูพุฑุณูุงู ุจู ุดฺฉู ูุฑูู ุธุงูุฑ ูโุดูุฏ ู ุฏฺฏุฑ ุดุฑูุฑุงู ุฑุง ูโุดูุงุณุฏ.",
        strategy: "ูุธูู ุงุตู ุดูุง ูุฑุจ ุฏุงุฏู ูพุฑุณูุงู ุงุณุช. ุณุน ฺฉูุฏ ูุซู ูุฑูู ุฑูุชุงุฑ ฺฉูุฏ: ุจุง ุงุนุชูุงุฏ ุจู ููุณุ ุขุฑุงู ู ุฑุงูููุง. ุงฺฏุฑ ุจุชูุงูุฏ ุงุนุชูุงุฏ ูพุฑุณูุงู ุฑุง ุฌูุจ ฺฉูุฏุ ุงู ุงุฒ ฺฉ ููุฑู ูุฏุฑุชููุฏ ุจุฑุง ุชู ูฺฉุ ุจู ฺฉ ูุดฺฉู ุจุฑุง ุขููุง ุชุจุฏู ูโุดูุฏ.",
        question: "ฺฺฏููู ูพุฑุณูุงู ุฑุง ุจูุชุฑ ูุฑุจ ุฏููุ ุณุน ฺฉูุฏ ุฏุฑ ูพุดููุงุฏ ุชูโูุง ููุทู ุนูู ฺฉูุฏ ู ฺฏุงู ุญุช ุจู ุชูโูุง ุฎูุจ ุฑุฃ ูุซุจุช ุฏูุฏ ุชุง ุงุนุชูุงุฏ ุฌูุจ ฺฉูุฏ."
    },
    [Role.Assassin]: {
        name: "ุขุฏูฺฉุด ๐ก๏ธ",
        ability: "ุงฺฏุฑ ุชู ูฺฉ ณ ูุงููุฑุช ุฑุง ุจุจุฑุฏุ ุงู ุจุง ุญุฏุณ ุฒุฏู ูุฑูู ูโุชูุงูุฏ ุชู ุดุฑ ุฑุง ุจุฑูุฏู ฺฉูุฏ.",
        strategy: "ุชูุงู ุชูุฑฺฉุฒ ุดูุง ุจุงุฏ ุฑู ูพุฏุง ฺฉุฑุฏู ูุฑูู ุจุงุดุฏ. ุจู ุฏูุจุงู ุจุงุฒฺฉู ุจฺฏุฑุฏุฏ ฺฉู ุจู ูุธุฑ ูโุฑุณุฏ ุงุทูุงุนุงุช ุฒุงุฏ ุฏุงุฑุฏ ู ุชู ุฑุง ูุฏุงุช ูโฺฉูุฏ. ฺฏุงู ูุงุฒู ุงุณุช ุจุฑุง ุฌูุจ ุงุนุชูุงุฏุ ุจู ฺฉ ูุงููุฑุช ุฑุฃ ููููุช ุจุฏูุฏ.",
        question: "ุขุง ููุดู ุจุงุฏ ูุงููุฑุชโูุง ุฑุง ุฎุฑุงุจ ฺฉููุ ุฎุฑ. ฺฏุงู ุจูุชุฑ ุงุณุช ฺฉ ูุงููุฑุช ูููู ุดูุฏ ุชุง ุดูุง ุจู ุนููุงู ฺฉ ูุฑู ุฎูุจ ุดูุงุฎุชู ุดูุฏ ู ุฏุฑ ุชูโูุง ุจุนุฏ ูุฑุงุฑ ุจฺฏุฑุฏ ู ุฏุฑ ูุญุธู ุญุณุงุณ ุถุฑุจู ุจุฒูุฏ."
    },
    [Role.Mordred]: {
        name: "ููุฑุฏุฑุฏ ๐ญ",
        ability: "ูุฑูู ุงู ุฑุง ููโุดูุงุณุฏ. ุฏฺฏุฑ ุดุฑูุฑุงู ุฑุง ูโุดูุงุณุฏ.",
        strategy: "ุดูุง ุจุฑฺฏ ุจุฑูุฏู ุชู ุดุฑ ูุณุชุฏ. ฺูู ูุฑูู ุดูุง ุฑุง ููโุดูุงุณุฏุ ูโุชูุงูุฏ ุจู ุฑุงุญุช ุงุนุชูุงุฏ ุชู ูฺฉ ุฑุง ุฌูุจ ฺฉูุฏ. ุฎูุฏ ุฑุง ฺฉ ุฎุฏูุชฺฏุฒุงุฑ ููุงุฏุงุฑ ุฌุง ุจุฒูุฏุ ุฏุฑ ุชูโูุง ูููุฐ ฺฉูุฏ ู ุฏุฑ ูููโุชุฑู ูุงููุฑุชโูุงุ ฺฉุงุฑุช ุดฺฉุณุช ุจุงุฒ ฺฉูุฏ.",
        question: "ุขุง ุจุงุฏ ุฎู ูุนุงู ุจุงุดู ุง ุณุงฺฉุชุ ุจูุชุฑ ุงุณุช ุชุนุงุฏู ุฑุง ุญูุธ ฺฉูุฏ. ฺฉ ุจุงุฒฺฉู ุฎูุจ ู ูุนุงู ุจู ูุธุฑ ุจุฑุณุฏ ุชุง ฺฉุณ ุจู ุดูุง ุดฺฉ ูฺฉูุฏ."
    },
    [Role.Oberon]: {
        name: "ุงูุจุฑูู ๐ถ",
        ability: "ุชู ุดุฑ ุฑุง ููโุดูุงุณุฏ ู ุขููุง ูู ุงู ุฑุง ููโุดูุงุณูุฏ.",
        strategy: "ุดูุง ฺฉ ฺฏุฑฺฏ ุชููุง ูุณุชุฏ. ุจุงุฏ ุฎูุฏุชุงู ููโุชูโูุง ุดุฑูุฑุชุงู ุฑุง ูพุฏุง ฺฉูุฏ. ุจู ุฑุฃโูุง ุฏูุช ฺฉูุฏ ุชุง ุจูููุฏ ฺู ฺฉุณุงู ูุซู ุดูุง ูฺฉุฑ ูโฺฉููุฏ. ฺฉุงุฑ ุดูุง ุณุฎุช ุงุณุชุ ฺูู ุงุฑุงูโุชุงู ูู ุดูุง ุฑุง ููโุดูุงุณูุฏ ู ููฺฉู ุงุณุช ุจู ุดูุง ุดฺฉ ฺฉููุฏ.",
        question: "ฺฺฏููู ุจุฏูู ุงูฺฉู ุดูุงุณุง ุดููุ ุจู ุชู ุดุฑ ฺฉูฺฉ ฺฉููุ ุจูุชุฑู ุฑุงู ุงู ุงุณุช ฺฉู ููุช ุฏุฑ ฺฉ ูุงููุฑุช ูุฑุงุฑ ฺฏุฑูุชุฏุ ุขู ุฑุง ุฎุฑุงุจ ฺฉูุฏ. ุงู ูุงุถุญโุชุฑู ูพุงู ุจุฑุง ููโุชูโูุง ุดูุงุณุช."
    }
};

const RoleGuide: React.FC<RoleGuideProps> = ({ onClose }) => {
  const [playerCount, setPlayerCount] = useState<number>(5);

  const rolesConfig = ROLE_CONFIGURATIONS[playerCount];
  const uniqueGoodRoles = [...new Set(rolesConfig.good)];
  const uniqueEvilRoles = [...new Set(rolesConfig.evil)];

  return (
    <div className="w-full h-full flex flex-col text-right">
      <div className="flex-shrink-0 flex items-center border-b border-gray-600 mb-4 pb-2">
        <h2 className="text-xl font-bold text-yellow-400">ุฑุงูููุง ููุดโูุง</h2>
        <button onClick={onClose} className="mr-auto text-gray-400 hover:text-white pr-2">
            <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
        </button>
      </div>

      <div className="flex-shrink-0 w-full max-w-sm mx-auto mb-4">
        <label htmlFor="player-count-guide" className="block mb-2 text-base text-center text-yellow-300">ููุงุด ุฑุงูููุง ุจุฑุง ุจุงุฒ:</label>
        <select
          id="player-count-guide"
          value={playerCount}
          onChange={(e) => setPlayerCount(Number(e.target.value))}
          className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-center focus:outline-none focus:ring-2 focus:ring-yellow-500"
        >
          {[...Array(6)].map((_, i) => (
            <option key={i + 5} value={i + 5}>{i + 5} ููุฑู</option>
          ))}
        </select>
      </div>

      <div className="flex-grow overflow-y-auto pr-2 space-y-6">
        <RoleSection title="ุชู ูฺฉุงู ๐" color="text-blue-400">
            {uniqueGoodRoles.map(role => {
                const content = ROLE_GUIDE_CONTENT[role];
                return content ? <RoleCard key={role} {...content} /> : null;
            })}
        </RoleSection>
        
        <RoleSection title="ุชู ุดุฑูุฑุงู ๐" color="text-red-400">
            {uniqueEvilRoles.map(role => {
                const content = ROLE_GUIDE_CONTENT[role];
                return content ? <RoleCard key={role} {...content} /> : null;
            })}
        </RoleSection>
      </div>
    </div>
  );
};

const RoleSection: React.FC<{ title: string, color: string, children: React.ReactNode }> = ({ title, color, children }) => (
    <div>
        <h3 className={`text-xl font-bold ${color} mb-3 pb-1 border-b-2 border-yellow-500/30`}>{title}</h3>
        <div className="space-y-4">{children}</div>
    </div>
);

const RoleCard: React.FC<{name: string, ability: string, strategy: string, question: string}> = ({name, ability, strategy, question}) => (
    <div className="bg-gray-800/50 rounded-lg p-4 border border-gray-600">
        <h4 className="text-lg font-bold text-yellow-300 mb-2">{name}</h4>
        <p className="text-gray-300"><span className="font-semibold text-gray-200">ูุงุจูุช: </span>{ability}</p>
        <p className="text-gray-300 mt-2"><span className="font-semibold text-gray-200">ุงุณุชุฑุงุชฺ: </span>{strategy}</p>
        <p className="text-gray-300 mt-2 italic bg-black/20 p-2 rounded"><span className="font-semibold text-gray-200">ุณูุงู ฺฉูุฏ: </span>{question}</p>
    </div>
)


export default RoleGuide;